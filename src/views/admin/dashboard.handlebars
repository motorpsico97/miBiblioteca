<link rel="stylesheet" href="/css/dashboard.css">

<div class="content">
    <div class="dashboard-header">
        <h2>Gesti√≥n de Libros</h2>
        <a href="/admin/books/create" class="btn-add">
            + Agregar Nuevo Libro
        </a>
    </div>

    {{#if success}}
    <div class="alert alert-success">{{success}}</div>
    {{/if}}

    <div class="search-bar">
        <form action="/admin/dashboard" method="GET" class="search-form">
            <input 
                type="text" 
                name="search" 
                class="search-input" 
                placeholder="Buscar por t√≠tulo, autor, editorial, categor√≠a, g√©nero, estado..."
                value="{{search}}"
            >
            <button type="submit" class="search-button">üîç Buscar</button>
            {{#if search}}
            <a href="/admin/dashboard" class="clear-search">‚úï Limpiar</a>
            {{/if}}
        </form>
        {{#if search}}
        <p class="search-results-info">
            {{#if libros.length}}
                Mostrando {{libros.length}} resultado(s) para "{{search}}"
            {{else}}
                No se encontraron resultados para "{{search}}"
            {{/if}}
        </p>
        {{/if}}
    </div>

    {{#if pagination}}
    <p class="pagination-info">
        Total: {{pagination.totalDocs}} libros | P√°gina {{pagination.page}} de {{pagination.totalPages}}
    </p>
    {{/if}}

    {{#if libros.length}}
    <table class="books-table">
        <thead>
            <tr>
                <th>T√≠tulo</th>
                <th>Autor</th>
                <th class="center">A√±o</th>
                <th>Editorial</th>
                <th class="center">Estado</th>
                <th class="center">Acciones</th>
            </tr>
        </thead>
        <tbody>
            {{#each libros}}
            <tr>
                <td>{{titulo}}</td>
                <td>{{autor}}</td>
                <td class="center">{{a√±o}}</td>
                <td>{{editorial}}</td>
                <td class="center">
                    <span class="status-badge status-{{estado}}">{{estado}}</span>
                </td>
                <td class="center">
                    <div class="action-buttons">
                        <a href="/admin/books/edit/{{_id}}" class="btn-edit">Editar</a>
                        <form action="/admin/books/delete/{{_id}}" method="POST" class="delete-form" onsubmit="return confirm('¬øEliminar este libro?');">
                            <button type="submit" class="btn-delete">Eliminar</button>
                        </form>
                    </div>
                </td>
            </tr>
            {{/each}}
        </tbody>
    </table>

    {{#if pagination}}
    <div class="pagination">
        {{#if pagination.hasPrevPage}}
        <a href="/admin/dashboard?page={{pagination.prevPage}}{{#if search}}&search={{search}}{{/if}}">‚Üê Anterior</a>
        {{/if}}
        
        <span class="current-page">{{pagination.page}}</span>
        
        {{#if pagination.hasNextPage}}
        <a href="/admin/dashboard?page={{pagination.nextPage}}{{#if search}}&search={{search}}{{/if}}">Siguiente ‚Üí</a>
        {{/if}}
    </div>
    {{/if}}

    {{else}}
    <p class="no-books">No hay libros registrados</p>
    {{/if}}
</div>
